#!/usr/bin/env ruby
# frozen_string_literal: true

require 'json'

puts "ğŸ§ª Running tests with coverage..."
system('bundle exec rspec')

if File.exist?('coverage/.last_run.json')
  coverage_data = JSON.parse(File.read('coverage/.last_run.json'))
  line_coverage = coverage_data['result']['line']
  branch_coverage = coverage_data['result']['branch']
  
  puts "\nğŸ“Š Coverage Summary:"
  puts "   Line Coverage: #{line_coverage}%"
  puts "   Branch Coverage: #{branch_coverage}%"
  puts "\nğŸ“ Detailed report: coverage/index.html"
else
  puts "âŒ No coverage data found"
end 
